const apiURL = 'https://frontend-api-experis-academy.herokuapp.com/trivia'
const apiKey = 'E4j2vtTmDfPR8BqptYOS4h2loXZl87fqeafsQMu6Nhz9WUp4LWlisPwMYgnLVT7k'

export const UserAPI = {
    // Getting user information by username
    async getUserByUsername(username) {
        try {
            const result = await fetch(`${apiURL}?username=${username}`).then(r => r.json())
            return [null, result]
        } catch (error) {
            return [error.message, null]
        }
    },
    // Creating a new user with username input, autogenerated id and high score value 0
    async addUser(username) {
        try {
            const result = await fetch(`${apiURL}`, {
                method: 'POST',
                headers: {
                    'X-API-Key': apiKey,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ 
                    username: username, 
                    highScore: 0 
                }) 
            })
            .then(result => result.json())
            return [null, result]

        } catch (error) {
            return [error.message, null]
        }
    },
    // Updating user's high score
    async editHighScore(userId, highScore) {
        try {
            const result = await fetch(`${apiURL}/${userId}`, {
                method: 'PATCH',
                headers: {
                    'X-API-Key': apiKey,
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    highScore: highScore  
                })
            })
            .then(result => result.json())
            return [null, result]
        } catch (error) {
            return [error.message, null]
        }
    }
}
